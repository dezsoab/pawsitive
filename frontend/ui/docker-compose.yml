services:
  nextjs_test:
    image: dezsoab/nextjs_test
    build: ./
    environment:
      - NODE_ENV=test

  nextjs_prod:
    image: dezsoab/nextjs_prod
    build: ./
    environment:
      - NODE_ENV=production

  nginx:
    image: dezsoab/nginx
    build: ./nginx
    restart: always
    volumes:
      # - /etc/letsencrypt/live/pawsitivecollar.com:/etc/letsencrypt/live/pawsitivecollar.com
      - ./nginx/default.conf/:/etc/nginx/conf.d/:ro
      - ./certbot/www:/var/www/certbot/:ro
    ports:
      - "80:80"
      - "443:443"

  certbot:
      image: certbot/certbot:latest
      volumes:
        - ./certbot/www/:/var/www/certbot/:rw
        - ./certbot/conf/:/etc/letsencrypt/:rw